"use strict";var map,restaurant=void 0,mapToggle=function(){var e=document.getElementById("map"),t=document.getElementById("togglemap"),r="false",a="Display map";"true"===t.getAttribute("aria-pressed")?(r="false",a="Display map",e.style.height="0",e.innerHTML=""):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:restaurant.latlng,scrollwheel:!1}),r="true",a="Hide map"),t.setAttribute("aria-pressed",r),t.setAttribute("aria-label",a),t.innerHTML=a,DBHelper.mapMarkerForRestaurant(self.restaurant,self.map)},fetchRestaurantFromURL=function(){return new Promise(function(r,a){if(self.restaurant)return r(self.restaurant);var e=getParameterByName("id");if(!e){return a("No restaurant id in URL")}DBHelper.fetchRestaurantById(e,function(e,t){if(!(self.restaurant=t))return a(e);fillRestaurantHTML(),DBHelper.fetchReviewByRestaurant(t.id).then(function(e){return fillReviewsHTML(e),fillFavouritesHTML(t.is_favorite),r(self.restaurant)}).catch(function(e){return a(e)})})})},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img");t.className="restaurant-img";var r=document.createElement("source");r.srcset="img/"+e.id+".webp",r.setAttribute("type","image/webp"),t.appendChild(r);var a=document.createElement("source");a.setAttribute("media","(min-width: 360px)"),a.srcset=DBHelper.imageUrlForRestaurant(e,"xsmall"),a.setAttribute("type","image/jpeg"),t.appendChild(a);var n=document.createElement("source");n.setAttribute("media","(min-width: 520px)"),n.srcset=DBHelper.imageUrlForRestaurant(e,"small"),n.setAttribute("type","image/jpeg"),t.appendChild(n);var i=document.createElement("source");i.setAttribute("media","(min-width: 800px)"),i.srcset=DBHelper.imageUrlForRestaurant(e,"medium"),i.setAttribute("type","image/jpeg"),t.appendChild(i);var s=document.createElement("source");s.setAttribute("media","(min-width: 1000px)"),s.srcset=DBHelper.imageUrlForRestaurant(e,"large"),s.setAttribute("type","image/jpeg"),t.appendChild(s);var l=document.createElement("source");l.setAttribute("media","(min-width: 1500px)"),l.srcset="/build/img/"+e.id+"-original.jpg",l.setAttribute("type","image/jpeg"),t.appendChild(l);var u=document.createElement("img");u.className="restaurant-img",u.src=DBHelper.imageUrlForRestaurant(e),u.alt="Image of "+e.name+" restaurant.",t.appendChild(u),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var r in e){var a=document.createElement("tr"),n=document.createElement("td");n.innerHTML=r,a.appendChild(n);var i=document.createElement("td");i.innerHTML=e[r],a.appendChild(i),t.appendChild(a)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),r=document.createElement("h3");if(r.innerHTML="Reviews",t.appendChild(r),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void t.appendChild(a)}var n=document.getElementById("reviews-list");e.forEach(function(e){n.appendChild(createReviewHTML(e))}),t.appendChild(n)},resetReviewsHTML=function(){var e=document.getElementById("reviews-container");e.innerHTML="";var t=document.createElement("ul");t.id="reviews-list",e.appendChild(t)},createReviewHTML=function(e){var t=document.createElement("li"),r=document.createElement("p");r.innerHTML=e.name,t.appendChild(r);var a=document.createElement("p");a.innerHTML=new Date(e.updatedAt).toLocaleDateString(),t.appendChild(a);var n=document.createElement("p");n.innerHTML="Rating: "+e.rating,t.appendChild(n);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),r=document.createElement("li");r.innerHTML=e.name,t.appendChild(r)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},submitReview=function(){var e={},t=document.getElementById("post-review-form"),r=document.getElementById("restaurant_id");r.value=parseInt(getParameterByName("id")),t.appendChild(r);for(var a=0;a<t.length;++a){var n=t[a].name,i=t[a].value;""!==n&&""!==i&&("restaurant_id"!==n&&"rating"!==n||(i=parseInt(i)),e[t[a].name]=i)}t.reset(),DBHelper.sendReview(e)},favoriteToggle=function(){var e=document.getElementById("is_fav");e.classList.toggle("is_favorite");var t="false",r="Mark as favourite";r="true"===e.getAttribute("aria-pressed")?(t="false","Mark as favourite"):(t="true","Remove favourite"),e.setAttribute("aria-pressed",t),e.setAttribute("aria-label",r),e.innerHTML=r;var a=getParameterByName("id");DBHelper.sendFavourite(a,t)},fillFavouritesHTML=function(e){var t=document.getElementById("is_fav"),r="",a="";"true"===e||!0===e?(r="true",a="Remove favourite",t.classList.add("is_favorite")):(r="false",a="Mark as favourite",t.classList.remove("is_favorite")),t.setAttribute("aria-pressed",r),t.setAttribute("aria-label",a),t.innerHTML=a};console.log("restaurant Init!!!"),fetchRestaurantFromURL().then(function(t){fillBreadcrumb(),document.getElementById("post-review-form").addEventListener("submit",function(e){e.preventDefault(),submitReview()}),document.addEventListener("update_reviews_list",function(e){resetReviewsHTML(),DBHelper.fetchReviewByRestaurant(t.id).then(function(e){fillReviewsHTML(e)})})}).catch(function(e){console.error("Init Error: ",e),console.log(e)});
//# sourceMappingURL=restaurant_info.js.map
